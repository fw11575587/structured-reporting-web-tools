<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="References for bone age">
    <meta name="author" content="I-Ta Tsai">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Structure Report</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- For IE 6/7/8 Responsive -->
    <!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <style type="text/css">
      html,
      body {
        height: 100%;
        /* The html and body elements cannot have any padding or margin. */
      }

      /* Wrapper for page content to push down footer */
      #wrap {
        min-height: 100%;
        height: auto !important;
        height: 100%;
        /* Negative indent footer by it's height */
        margin: 0 auto -50px;
      }

      /* Set the fixed height of the footer here */
      #push,
      #footer {
        height: 50px;
      }
      #footer {
        background-color: #f5f5f5;
      }
    </style>
  </head>

  <body>
    <div id="wrap">
      <div class="container">

        <div class="masthead">
          <h2 class="text-muted">Structure Report</h2>
        </div>

        <div class="body-content">

          <!-- Example row of columns -->
          <div class="row">
            <div class="col-lg-12">
              <ul id="myTab" class="nav nav-tabs">
                <li class="active">
                  <a href="#djdl" data-toggle="tab" id="tabDJDL">DJD L-spine</a>
                </li>
                <li>
                  <a href="#djdc" data-toggle="tab" id="tabDJDC">DJD C-spine</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="row">
            <form id="form-djd-l" class="form-horizontal" role="form">
              <div class="col-lg-6">
                <!-- L1-L2 -->
                <div class="form-group" id="L1-L2">
                  <label for="tabl1-2" class="col-lg-2 control-label">L1-L2</label>
                  <div class="col-lg-10">
                    <!-- Disk Space Narrowing -->
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_dsn" value="">
                        Disk space narrowing
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l12" value="1">
                        mild
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l12" value="2">
                        moderate
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l12" value="3">
                        severe
                      </label>
                    </div>

                    <div class="">
                      <!-- Retrolisthesis -->
                      <label class="checkbox-inline col-lg-6">
                        <input type="checkbox" class="cb_retro" value="">
                        Retrolisthesis
                      </label>

                      <!-- Hypermobility -->
                      <label class="checkbox-inline">
                        <input type="checkbox" class="cb_hyper" value="">
                        Hypermobility
                      </label>
                    </div>

                    <!-- Degenerative Spondylolisthesis -->
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_deg_spon" value="">
                        Degenerative spondylolisthesis
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l12" value="1">
                        grade 1
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l12" value="2">
                        grade 2
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l12" value="3">
                        grade 3
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l12" value="4">
                        grade 4
                      </label>
                    </div>
                  </div>
                </div>
                <!-- L2-L3 -->
                <div class="form-group" id="L2-L3">
                  <label for="tabl1-2" class="col-lg-2 control-label">L2-L3</label>
                  <div class="col-lg-10">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_dsn" value="">
                        Disk space narrowing
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l23" value="1">
                        mild
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l23" value="2">
                        moderate
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l23" value="3">
                        severe
                      </label>
                    </div>

                    <div class="">
                      <label class="checkbox-inline col-lg-6">
                        <input type="checkbox" class="cb_retro" value="">
                        Retrolisthesis
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" class="cb_hyper" value="">
                        Hypermobility
                      </label>
                    </div>
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_deg_spon" value="">
                        Degenerative spondylolisthesis
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l23" value="1">
                        grade 1
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l23" value="2">
                        grade 2
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l23" value="3">
                        grade 3
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l23" value="4">
                        grade 4
                      </label>
                    </div>
                  </div>
                </div>
                <!-- L3-L4 -->
                <div class="form-group" id="L3-L4">
                  <label for="tabl1-2" class="col-lg-2 control-label">L3-L4</label>
                  <div class="col-lg-10">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_dsn" value="">
                        Disk space narrowing
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l34" value="1">
                        mild
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l34" value="2">
                        moderate
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l34" value="3">
                        severe
                      </label>
                    </div>

                    <div class="">
                      <label class="checkbox-inline col-lg-6">
                        <input type="checkbox" class="cb_retro" value="">
                        Retrolisthesis
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" class="cb_hyper" value="">
                        Hypermobility
                      </label>
                    </div>
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_deg_spon" value="">
                        Degenerative spondylolisthesis
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l34" value="1">
                        grade 1
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l34" value="2">
                        grade 2
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l34" value="3">
                        grade 3
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l34" value="4">
                        grade 4
                      </label>
                    </div>
                  </div>
                </div>
                <!-- L4-L5 -->
                <div class="form-group" id="L4-L5">
                  <label for="tabl1-2" class="col-lg-2 control-label">L4-L5</label>
                  <div class="col-lg-10">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_dsn" value="">
                        Disk space narrowing
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l45" value="1">
                        mild
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l45" value="2">
                        moderate
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l45" value="3">
                        severe
                      </label>
                    </div>

                    <div class="">
                      <label class="checkbox-inline col-lg-6">
                        <input type="checkbox" class="cb_retro" value="">
                        Retrolisthesis
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" class="cb_hyper" value="">
                        Hypermobility
                      </label>
                    </div>
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_deg_spon" value="">
                        Degenerative spondylolisthesis
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l45" value="1">
                        grade 1
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l45" value="2">
                        grade 2
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l45" value="3">
                        grade 3
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l45" value="4">
                        grade 4
                      </label>
                    </div>
                  </div>
                </div>
                <!-- L5-S1 -->
                <div class="form-group" id="L5-S1">
                  <label for="tabl1-2" class="col-lg-2 control-label">L5-S1</label>
                  <div class="col-lg-10">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_dsn" value="">
                        Disk space narrowing
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l51" value="1">
                        mild
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l51" value="2">
                        moderate
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="disc_space_narrowing" name="disc_space_l51" value="3">
                        severe
                      </label>
                    </div>

                    <div class="">
                      <label class="checkbox-inline col-lg-6">
                        <input type="checkbox" class="cb_retro" value="">
                        Retrolisthesis
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" class="cb_hyper" value="">
                        Hypermobility
                      </label>
                    </div>
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" class="cb_deg_spon" value="">
                        Degenerative spondylolisthesis
                      </label>
                    </div>
                    <div class="col-lg-offset-1">
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l51" value="1">
                        grade 1
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l51" value="2">
                        grade 2
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l51" value="3">
                        grade 3
                      </label>
                      <label class="radio-inline">
                        <input type="radio" class="deg_spon" name="deg_spon_l51" value="4">
                        grade 4
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- second column -->
              <div class="col-lg-6">
                <div class="row">
                  <div class="col-lg-12">
                    <!-- OTHERS -->
                    <div class="form-group">
                      <label for="tab-other" class="col-lg-2 control-label">Others</label>
                      <div class="col-lg-10">
                        <!-- Degenerative lower lumbar facet joints -->
                        <div class="checkbox">
                          <label>
                            <input type="checkbox" class="cb_dllfj" value="" checked >
                            Degenerative lower lumbar facet joints
                          </label>
                        </div>

                        <!-- Marginal osteophyte -->
                        <div class="checkbox">
                          <label>
                            <input type="checkbox" class="cb_mo" value="" checked >
                            Marginal osteophyte
                          </label>
                        </div>

                        <!-- Scoliosis -->
                        <div class="checkbox">
                          <label>
                            <input type="checkbox" class="cb_scoliosis" value="" >
                            Scoliosis
                          </label>
                        </div>
                        <div class="col-lg-offset-1">
                          <label class="radio-inline">
                            <input type="radio" class="scoliosis" name="scol_side" value="0">
                            Left
                          </label>
                          <label class="radio-inline">
                            <input type="radio" class="scoliosis" name="scol_side" value="1">
                            Right
                          </label>
                        </div>

                        <!-- Lumbosacral Transitional Vertebrae -->
                        <div class="checkbox">
                          <label>
                            <input type="checkbox" class="cb_ltsv" value="" >
                            LTSV
                          </label>
                        </div>
                        <div class="col-lg-offset-1">
                          <label class="radio-inline">
                            <input type="radio" class="ltsv" name="lstv_stage" value="1">
                            I
                          </label>
                          <label class="radio-inline">
                            <input type="radio" class="ltsv" name="lstv_stage" value="2">
                            II
                          </label>
                          <label class="radio-inline">
                            <input type="radio" class="ltsv" name="lstv_stage" value="3">
                            III
                          </label>
                          <label class="radio-inline">
                            <input type="radio" class="ltsv" name="lstv_stage" value="4">
                            IV
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Report -->
                <div class="row">
                  <div class="col-lg-12 well">
                    <button type="button" id="btn_clear" class="btn btn-info">Clear</button>
                    <textarea id="result" class="form-control" rows="15"></textarea>
                  </div>
                </div>
              </div>
            </form>
          </div>

        </div><!-- /.body-content -->

        <div id="push"></div>
      </div> <!-- /container -->
    </div> <!-- /wrap -->

    <!-- Site footer -->
    <div id="footer">
      <div class="container">
        <p class="text-muted credit">&copy; tsaiid@VGHKS 2013</p>
      </div>
    </div>

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <script>
      $().tab;

      var DJDLForm = 'Lumbar spine:' + "\n";

      // Control for radio and checkbox.
      // Disc Space Narrowing
      $('.disc_space_narrowing').change(function(){
        var cb_dsn = $(this).parent().parent().parent().find('.cb_dsn');

        if (!cb_dsn.is(':checked')) {
          cb_dsn.click();
        }
      });

      $('.cb_dsn').change(function(){
        if (!$(this).is(':checked')) {
          $(this).parent().parent().next().find(':radio').prop('checked', false);
        } else {
          // set default degree to mild.
          if ($(this).parent().parent().next().find(':radio:checked').length == 0) {
            $(this).parent().parent().next().find(':radio').first().prop('checked', true);
          }
        }
      });

      // Degenerative Spondylolisthesis
      $('.deg_spon').change(function(){
        var cb_deg_spon = $(this).parent().parent().parent().find('.cb_deg_spon');

        if (!cb_deg_spon.is(':checked')) {
          cb_deg_spon.click();
        }
      });

      $('.cb_deg_spon').change(function(){
        if (!$(this).is(':checked')) {
          $(this).parent().parent().next().find(':radio').prop('checked', false);
        } else {
          // set default grade to 1.
          if ($(this).parent().parent().next().find(':radio:checked').length == 0) {
            $(this).parent().parent().next().find(':radio').first().prop('checked', true);
          }
        }
      });

      // Scoliosis
      $('.scoliosis').change(function(){
        var cb_scoliosis = $(this).parent().parent().parent().find('.cb_scoliosis');

        if (!cb_scoliosis.is(':checked')) {
          cb_scoliosis.click();
        }
      });

      $('.cb_scoliosis').change(function(){
        if (!$(this).is(':checked')) {
          $(this).parent().parent().next().find(':radio').prop('checked', false);
        } else {
          // set default grade to Left.
          if ($(this).parent().parent().next().find(':radio:checked').length == 0) {
            $(this).parent().parent().next().find(':radio').first().prop('checked', true);
          }
        }
      });

      $(':checkbox, :radio').change(function(){
        analyze();
      });

      $('#btn_clear').click(function(){
        $(':checkbox, :radio').prop('checked', false);
        $('#result').text('');
      });

      // # Analysis for output.
      function analyze () {
        var str = DJDLForm;
        var retro = [];
        var hyper = [];
        var scol_text = ['left', 'right'];

        // Disc Space Narrowing
        if ($('.disc_space_narrowing:checked').length == 0) {
          str += '  - No obvious disc space narrowing. ' + "\n";
        } else {
          var degree = [];
          var degree_text = ['', 'mild', 'moderate', 'severe'];
          var has_disc_space_narrowing = false;

          $('.disc_space_narrowing:checked').each(function(){
            var level = $(this).parent().parent().parent().parent().attr('id');
            if (typeof degree[$(this).val()] == "undefined") {
              degree[$(this).val()] = new Array();
            }
            degree[$(this).val()].push(level);
            has_disc_space_narrowing = true;
          });

          if (has_disc_space_narrowing) {
            str += "  - Disc space narrowing:\n";
          }

          for (i = 1; i < 4; i++) {
            if (typeof degree[i] != "undefined" && degree[i].length) {
              str += "    - " + degree[i].join(', ') + ': ' + degree_text[i] + "\n";
            }
          }
        }

        // Retrolisthesis
        $('.cb_retro:checked').each(function(){
          var level = $(this).parent().parent().parent().parent().attr('id');
          retro.push(level);
        });

        if (retro.length) {
          str += "  - Retrolisthesis: " + retro.join(', ') + "\n";
        } else {
          str += "  - No retrolisthesis.\n";
        }

        // Degenerative Spondylolisthesis
        if ($('.deg_spon:checked').length == 0) {
          str += '  - No degenerative spondylolisthesis. ' + "\n";
        } else {
          var grade = [];
          //var grade_text = ['', 'mild', 'moderate', 'severe'];
          var has_spondylolisthesis = false;

          $('.deg_spon:checked').each(function(){
            var level = $(this).parent().parent().parent().parent().attr('id');
            if (typeof grade[$(this).val()] == "undefined") {
              grade[$(this).val()] = new Array();
            }
            grade[$(this).val()].push(level);
            has_spondylolisthesis = true;
          });

          if (has_spondylolisthesis) {
            str += "  - Degenerative Spondylolisthesis:\n";
          }

          for (i = 1; i < 5; i++) {
            if (typeof grade[i] != "undefined" && grade[i].length) {
              str += "    - " + grade[i].join(', ') + ': grade ' + i + ".\n";
            }
          }
        }

        // Degenerative lower lumbar facet joints
        if ($('.cb_dllfj:checked').length) {
          str += "  - Degenerative lower lumbar facet joints.\n";
        }

        // Marginal osteophyte
        if ($('.cb_mo:checked').length) {
          str += "  - Marginal osteophyte.\n";
        }

        // Hypermobility
        $('.cb_hyper:checked').each(function(){
          var level = $(this).parent().parent().parent().parent().attr('id');
          hyper.push(level);
        });

        if (hyper.length) {
          str += "  - Hypermobility: " + hyper.join(', ') + "\n";
        } else {
          str += "  - No hypermobility.\n";
        }

        // Scoliosis
        if ($('.cb_scoliosis:checked').length) {
          str += "  - Scoliosis with " + scol_text[$('.scoliosis:checked').first().val()] + " lateral convexity.\n";
        }

        $('#result').text(str);
        return false;
      }
    </script>
  </body>
</html>